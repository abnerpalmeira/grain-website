const locales = {
  'pt-BR': {
    // Meta tags
    title: 'Grain Pixel — Fun with Particles',
    description: 'Grain Pixel é um sandbox de partículas em pixel art. Crie, destrua e experimente com fogo, água, areia e muito mais.',
    
    // Header
    brandTitle: 'Grain Pixel',
    brandLogoAlt: 'Logo em pixel do Grain',
    appStoreAlt: 'Disponível na App Store',
    googlePlayAlt: 'Disponível no Google Play',
    steamAlt: 'Wishlist no Steam',
    wishlist: 'Wishlist',
    
    // Hero section
    heroTitle: 'Fun with Particles',
    tagline: 'Um sandbox de partículas em pixel art para você criar, destruir e experimentar mundos vivos.',
    downloadBtn: 'Baixar',
    watchTrailerBtn: 'Assistir Trailer',
    
    // About section
    aboutTitle: 'Sobre o Jogo',
    aboutText: 'Grain Pixel combina física divertida com estética retrô. Misture <strong>fogo</strong>, <strong>água</strong>, <strong>areia</strong>, <strong>gelo</strong>, <strong>vapor</strong> e dezenas de elementos para ver o mundo reagir em tempo real. Crie cenários, acenda dinamites, congele cascatas, e descubra interações emergentes. Simples de jogar, profundo para dominar.',
    aboutAvailability: 'Disponível para <strong>iOS</strong> e com versão <strong>PC</strong> em desenvolvimento.',
    
    // Gallery
    screenshot1: 'Screenshot 1: deserto com pirâmide',
    screenshot2: 'Screenshot 2: floresta pegando fogo',
    screenshot3: 'Screenshot 3: noite com lua',
    screenshot4: 'Screenshot 4: menu de elementos',
    screenshot5: 'Screenshot 5: bioma de neve',
    screenshot6: 'Screenshot 6: seleção de níveis',
    
    // Gallery images - localized for pt-BR
    galleryImages: [
      { src: 'assets/screenshots/default/IMG_0761.PNG', alt: 'screenshot1' },
      { src: 'assets/screenshots/default/IMG_0773.PNG', alt: 'screenshot2' },
      { src: 'assets/screenshots/default/IMG_0823.PNG', alt: 'screenshot3' },
      { src: 'assets/screenshots/pt_BR/elements.PNG', alt: 'screenshot4' },
      { src: 'assets/screenshots/pt_BR/settings.PNG', alt: 'screenshot5' },
      { src: 'assets/screenshots/pt_BR/levels.PNG', alt: 'screenshot6' }
    ],
    
    // Features section
    featuresTitle: 'Recursos',
    physicsTitle: 'Física de Partículas',
    physicsDesc: 'Simulações em tempo real com fogo, água, areia, fumaça, gelo, vapor e muito mais.',
    biomesTitle: 'Biomas e Níveis',
    biomesDesc: 'Ambientes que influenciam nas reações: deserto, noite eterna, campos em flor, montanhas de magma.',
    explosivesTitle: 'Brinquedos Explosivos',
    explosivesDesc: 'Dinamite, ácido, e mais. Descubra combinações caóticas e hilárias.',
    controlsTitle: 'Controle Simples',
    controlsDesc: 'Toque e arraste. Interface feita para telas touch — perfeita para iPhone e iPad.',
    performanceTitle: 'Performance Mobile',
    performanceDesc: 'Roda liso com milhares de partículas, com feedback háptico opcional.',
    pixelArtTitle: 'Pixel Art',
    pixelArtDesc: 'Visual retro caprichado, com paletas vivas e UI em estilo arcade.',
    
    // Trailer section
    trailerTitle: 'Trailer',
    downloadTitle: 'Baixar / Wishlist',
    downloadText: 'Entre para a lista de desejos no Steam e baixe na App Store quando disponível.',
    newsletterText: 'Receba novidades por e-mail quando sair uma atualização grande.',
    emailPlaceholder: 'seunome@email.com',
    emailLabel: 'Seu e-mail',
    subscribeBtn: 'Quero ser avisado',
    subscribeSuccess: 'Valeu! Vamos te avisar.',
    
    // Roadmap section
    roadmapTitle: 'Roadmap',
    now: 'Agora',
    wishlist: 'Wishlist',
    future: 'Futuro',
    acidTitle: 'Novo Elemento: Ácido',
    acidDesc: 'Interações com areia, pedra e água + efeitos visuais brilhantes.',
    editorTitle: 'Editor de Cenários',
    editorDesc: 'Monte seu bioma, salve e compartilhe capturas animadas.',
    pcTitle: 'Versão PC',
    pcDesc: 'Aprimoramentos de input, performance e mods leves.',
    
    // Footer
    privacyPolicy: 'Política de Privacidade',
    termsOfUse: 'Termos de Uso',
    contact: 'Contato',
    
    // Lightbox
    lightboxAlt: 'Imagem ampliada',
    
    // Navigation
    navigation: 'Topo',
    stores: 'Lojas',
    hero: 'Herói',
    gallery: 'Galeria de imagens',
    trailer: 'Trailer do jogo',
    brand: 'Marca',
    imageViewer: 'Visualizador de imagem'
  },
  
  'en-US': {
    // Meta tags
    title: 'Grain Pixel — Fun with Particles',
    description: 'Grain Pixel is a pixel art particle sandbox. Create, destroy and experiment with fire, water, sand and much more.',
    
    // Header
    brandTitle: 'Grain Pixel',
    brandLogoAlt: 'Grain pixel logo',
    appStoreAlt: 'Download on the App Store',
    googlePlayAlt: 'Get it on Google Play',
    steamAlt: 'Add to Steam Wishlist',
    wishlist: 'Wishlist',
    
    // Hero section
    heroTitle: 'Fun with Particles',
    tagline: 'A pixel art particle sandbox for you to create, destroy and experiment with living worlds.',
    downloadBtn: 'Download',
    watchTrailerBtn: 'Watch Trailer',
    
    // About section
    aboutTitle: 'About the Game',
    aboutText: 'Grain Pixel combines fun physics with retro aesthetics. Mix <strong>fire</strong>, <strong>water</strong>, <strong>sand</strong>, <strong>ice</strong>, <strong>steam</strong> and dozens of elements to see the world react in real time. Create scenarios, light dynamites, freeze waterfalls, and discover emergent interactions. Simple to play, deep to master.',
    aboutAvailability: 'Available for <strong>iOS</strong> with <strong>PC</strong> version in development.',
    
    // Gallery
    screenshot1: 'Screenshot 1: desert with pyramid',
    screenshot2: 'Screenshot 2: forest on fire',
    screenshot3: 'Screenshot 3: night with moon',
    screenshot4: 'Screenshot 4: elements menu',
    screenshot5: 'Screenshot 5: snow biome',
    screenshot6: 'Screenshot 6: level selection',
    
    // Gallery images - localized for en-US
    galleryImages: [
      { src: 'assets/screenshots/default/IMG_0761.PNG', alt: 'screenshot1' },
      { src: 'assets/screenshots/default/IMG_0773.PNG', alt: 'screenshot2' },
      { src: 'assets/screenshots/default/IMG_0823.PNG', alt: 'screenshot3' },
      { src: 'assets/screenshots/en/elements.PNG', alt: 'screenshot4' },
      { src: 'assets/screenshots/en/settings.PNG', alt: 'screenshot5' },
      { src: 'assets/screenshots/en/levels.PNG', alt: 'screenshot6' }
    ],
    
    // Features section
    featuresTitle: 'Features',
    physicsTitle: 'Particle Physics',
    physicsDesc: 'Real-time simulations with fire, water, sand, smoke, ice, steam and much more.',
    biomesTitle: 'Biomes & Levels',
    biomesDesc: 'Environments that influence reactions: desert, eternal night, flowering fields, magma mountains.',
    explosivesTitle: 'Explosive Toys',
    explosivesDesc: 'Dynamite, acid, and more. Discover chaotic and hilarious combinations.',
    controlsTitle: 'Simple Controls',
    controlsDesc: 'Touch and drag. Interface made for touch screens — perfect for iPhone and iPad.',
    performanceTitle: 'Mobile Performance',
    performanceDesc: 'Runs smoothly with thousands of particles, with optional haptic feedback.',
    pixelArtTitle: 'Pixel Art',
    pixelArtDesc: 'Polished retro visuals, with vibrant palettes and arcade-style UI.',
    
    // Trailer section
    trailerTitle: 'Trailer',
    downloadTitle: 'Download / Wishlist',
    downloadText: 'Join the Steam wishlist and download from the App Store now.',
    newsletterText: 'Get email updates when major updates are released.',
    emailPlaceholder: 'yourname@email.com',
    emailLabel: 'Your email',
    subscribeBtn: 'Notify me',
    subscribeSuccess: 'Thanks! We\'ll let you know.',
    
    // Roadmap section
    roadmapTitle: 'Roadmap',
    now: 'Now',
    wishlist: 'Wishlist',
    future: 'Future',
    acidTitle: 'New Element: Acid',
    acidDesc: 'Interactions with sand, stone and water + brilliant visual effects.',
    editorTitle: 'Scenario Editor',
    editorDesc: 'Build your biome, save and share animated captures.',
    pcTitle: 'PC Version',
    pcDesc: 'Input improvements, performance and light mods.',
    
    // Footer
    privacyPolicy: 'Privacy Policy',
    termsOfUse: 'Terms of Use',
    contact: 'Contact',
    
    // Lightbox
    lightboxAlt: 'Enlarged image',
    
    // Navigation
    navigation: 'Top',
    stores: 'Stores',
    hero: 'Hero',
    gallery: 'Image gallery',
    trailer: 'Game trailer',
    brand: 'Brand',
    imageViewer: 'Image viewer'
  },
  
  'de': {
    // Meta tags
    title: 'Grain Pixel — Fun with Particles',
    description: 'Grain Pixel ist ein Pixel-Art-Partikel-Sandbox. Erschaffe, zerstöre und experimentiere mit Feuer, Wasser, Sand und vielem mehr.',
    
    // Header
    brandTitle: 'Grain Pixel',
    brandLogoAlt: 'Grain Pixel-Logo',
    appStoreAlt: 'Im App Store verfügbar',
    googlePlayAlt: 'Bei Google Play verfügbar',
    steamAlt: 'Zur Steam-Wunschliste hinzufügen',
    wishlist: 'Wunschliste',
    
    // Hero section
    heroTitle: 'Fun with Particles',
    tagline: 'Ein Pixel-Art-Partikel-Sandbox, in dem du lebende Welten erschaffen, zerstören und mit ihnen experimentieren kannst.',
    downloadBtn: 'Herunterladen',
    watchTrailerBtn: 'Trailer ansehen',
    
    // About section
    aboutTitle: 'Über das Spiel',
    aboutText: 'Grain Pixel kombiniert lustige Physik mit Retro-Ästhetik. Mische <strong>Feuer</strong>, <strong>Wasser</strong>, <strong>Sand</strong>, <strong>Eis</strong>, <strong>Dampf</strong> und Dutzende von Elementen, um zu sehen, wie die Welt in Echtzeit reagiert. Erstelle Szenarien, zünde Dynamit an, friere Wasserfälle ein und entdecke aufkommende Interaktionen. Einfach zu spielen, tiefgründig zu meistern.',
    aboutAvailability: 'Verfügbar für <strong>iOS</strong> mit <strong>PC</strong>-Version in Entwicklung.',
    
    // Gallery
    screenshot1: 'Screenshot 1: Wüste mit Pyramide',
    screenshot2: 'Screenshot 2: Wald in Flammen',
    screenshot3: 'Screenshot 3: Nacht mit Mond',
    screenshot4: 'Screenshot 4: Elemente-Menü',
    screenshot5: 'Screenshot 5: Schnee-Biom',
    screenshot6: 'Screenshot 6: Level-Auswahl',
    
    // Gallery images - localized for German
    galleryImages: [
      { src: 'assets/screenshots/default/IMG_0761.PNG', alt: 'screenshot1' },
      { src: 'assets/screenshots/default/IMG_0773.PNG', alt: 'screenshot2' },
      { src: 'assets/screenshots/default/IMG_0823.PNG', alt: 'screenshot3' },
      { src: 'assets/screenshots/de/elements.PNG', alt: 'screenshot4' },
      { src: 'assets/screenshots/de/settings.PNG', alt: 'screenshot5' },
      { src: 'assets/screenshots/de/levels.PNG', alt: 'screenshot6' }
    ],
    
    // Features section
    featuresTitle: 'Funktionen',
    physicsTitle: 'Partikelphysik',
    physicsDesc: 'Echtzeit-Simulationen mit Feuer, Wasser, Sand, Rauch, Eis, Dampf und vielem mehr.',
    biomesTitle: 'Biome & Level',
    biomesDesc: 'Umgebungen, die Reaktionen beeinflussen: Wüste, ewige Nacht, blühende Felder, Magma-Berge.',
    explosivesTitle: 'Explosive Spielzeuge',
    explosivesDesc: 'Dynamit, Säure und mehr. Entdecke chaotische und urkomische Kombinationen.',
    controlsTitle: 'Einfache Steuerung',
    controlsDesc: 'Berühren und ziehen. Interface für Touchscreens gemacht — perfekt für iPhone und iPad.',
    performanceTitle: 'Mobile Performance',
    performanceDesc: 'Läuft flüssig mit Tausenden von Partikeln, mit optionalem haptischem Feedback.',
    pixelArtTitle: 'Pixel Art',
    pixelArtDesc: 'Polierte Retro-Grafiken mit lebendigen Paletten und Arcade-Style UI.',
    
    // Trailer section
    trailerTitle: 'Trailer',
    downloadTitle: 'Herunterladen / Wunschliste',
    downloadText: 'Tritt der Steam-Wunschliste bei und lade von der App Store herunter, wenn verfügbar.',
    newsletterText: 'Erhalte E-Mail-Updates bei wichtigen Updates.',
    emailPlaceholder: 'deinname@email.com',
    emailLabel: 'Deine E-Mail',
    subscribeBtn: 'Benachrichtige mich',
    subscribeSuccess: 'Danke! Wir lassen es dich wissen.',
    
    // Roadmap section
    roadmapTitle: 'Roadmap',
    now: 'Jetzt',
    wishlist: 'Wunschliste',
    future: 'Zukunft',
    acidTitle: 'Neues Element: Säure',
    acidDesc: 'Interaktionen mit Sand, Stein und Wasser + brillante visuelle Effekte.',
    editorTitle: 'Szenario-Editor',
    editorDesc: 'Baue dein Biom, speichere und teile animierte Aufnahmen.',
    pcTitle: 'PC-Version',
    pcDesc: 'Input-Verbesserungen, Performance und leichte Mods.',
    
    // Footer
    privacyPolicy: 'Datenschutzrichtlinie',
    termsOfUse: 'Nutzungsbedingungen',
    contact: 'Kontakt',
    
    // Lightbox
    lightboxAlt: 'Vergrößertes Bild',
    
    // Navigation
    navigation: 'Nach oben',
    stores: 'Shops',
    hero: 'Held',
    gallery: 'Bildergalerie',
    trailer: 'Spiel-Trailer',
    brand: 'Marke',
    imageViewer: 'Bildbetrachter'
  },
  
  'fr': {
    // Meta tags
    title: 'Grain Pixel — Fun with Particles',
    description: 'Grain Pixel est un bac à sable de particules en pixel art. Créez, détruisez et expérimentez avec le feu, l\'eau, le sable et bien plus encore.',
    
    // Header
    brandTitle: 'Grain Pixel',
    brandLogoAlt: 'Logo Grain Pixel',
    appStoreAlt: 'Disponible sur l\'App Store',
    googlePlayAlt: 'Disponible sur Google Play',
    steamAlt: 'Ajouter à la liste de souhaits Steam',
    wishlist: 'Liste de souhaits',
    
    // Hero section
    heroTitle: 'Fun with Particles',
    tagline: 'Un bac à sable de particules en pixel art pour créer, détruire et expérimenter avec des mondes vivants.',
    downloadBtn: 'Télécharger',
    watchTrailerBtn: 'Regarder la bande-annonce',
    
    // About section
    aboutTitle: 'À propos du jeu',
    aboutText: 'Grain Pixel combine une physique amusante avec une esthétique rétro. Mélangez <strong>feu</strong>, <strong>eau</strong>, <strong>sable</strong>, <strong>glace</strong>, <strong>vapeur</strong> et des dizaines d\'éléments pour voir le monde réagir en temps réel. Créez des scénarios, allumez des dynamites, congelez des cascades et découvrez des interactions émergentes. Simple à jouer, profond à maîtriser.',
    aboutAvailability: 'Disponible pour <strong>iOS</strong> avec version <strong>PC</strong> en développement.',
    
    // Gallery
    screenshot1: 'Capture d\'écran 1: désert avec pyramide',
    screenshot2: 'Capture d\'écran 2: forêt en feu',
    screenshot3: 'Capture d\'écran 3: nuit avec lune',
    screenshot4: 'Capture d\'écran 4: menu des éléments',
    screenshot5: 'Capture d\'écran 5: biome de neige',
    screenshot6: 'Capture d\'écran 6: sélection de niveau',
    
    // Gallery images - localized for French
    galleryImages: [
      { src: 'assets/screenshots/default/IMG_0761.PNG', alt: 'screenshot1' },
      { src: 'assets/screenshots/default/IMG_0773.PNG', alt: 'screenshot2' },
      { src: 'assets/screenshots/default/IMG_0823.PNG', alt: 'screenshot3' },
      { src: 'assets/screenshots/fr/IMG_0794.PNG', alt: 'screenshot4' },
      { src: 'assets/screenshots/fr/IMG_0795.PNG', alt: 'screenshot5' },
      { src: 'assets/screenshots/fr/IMG_0796.PNG', alt: 'screenshot6' }
    ],
    
    // Features section
    featuresTitle: 'Fonctionnalités',
    physicsTitle: 'Physique des particules',
    physicsDesc: 'Simulations en temps réel avec feu, eau, sable, fumée, glace, vapeur et bien plus encore.',
    biomesTitle: 'Biomes et niveaux',
    biomesDesc: 'Environnements qui influencent les réactions: désert, nuit éternelle, champs fleuris, montagnes de magma.',
    explosivesTitle: 'Jouets explosifs',
    explosivesDesc: 'Dynamite, acide et plus encore. Découvrez des combinaisons chaotiques et hilarantes.',
    controlsTitle: 'Contrôles simples',
    controlsDesc: 'Touchez et glissez. Interface conçue pour les écrans tactiles — parfaite pour iPhone et iPad.',
    performanceTitle: 'Performance mobile',
    performanceDesc: 'Fonctionne en douceur avec des milliers de particules, avec retour haptique optionnel.',
    pixelArtTitle: 'Pixel Art',
    pixelArtDesc: 'Visuels rétro soignés, avec des palettes vibrantes et une UI de style arcade.',
    
    // Trailer section
    trailerTitle: 'Bande-annonce',
    downloadTitle: 'Télécharger / Liste de souhaits',
    downloadText: 'Rejoignez la liste de souhaits Steam et téléchargez depuis l\'App Store quand disponible.',
    newsletterText: 'Recevez des mises à jour par e-mail lors de mises à jour majeures.',
    emailPlaceholder: 'votrenom@email.com',
    emailLabel: 'Votre e-mail',
    subscribeBtn: 'Notifiez-moi',
    subscribeSuccess: 'Merci ! Nous vous tiendrons au courant.',
    
    // Roadmap section
    roadmapTitle: 'Feuille de route',
    now: 'Maintenant',
    wishlist: 'Liste de souhaits',
    future: 'Avenir',
    acidTitle: 'Nouvel élément: Acide',
    acidDesc: 'Interactions avec le sable, la pierre et l\'eau + effets visuels brillants.',
    editorTitle: 'Éditeur de scénarios',
    editorDesc: 'Construisez votre biome, sauvegardez et partagez des captures animées.',
    pcTitle: 'Version PC',
    pcDesc: 'Améliorations d\'entrée, performance et mods légers.',
    
    // Footer
    privacyPolicy: 'Politique de confidentialité',
    termsOfUse: 'Conditions d\'utilisation',
    contact: 'Contact',
    
    // Lightbox
    lightboxAlt: 'Image agrandie',
    
    // Navigation
    navigation: 'Haut',
    stores: 'Magasins',
    hero: 'Héros',
    gallery: 'Galerie d\'images',
    trailer: 'Bande-annonce du jeu',
    brand: 'Marque',
    imageViewer: 'Visionneuse d\'image'
  }
};

// Language switcher functionality
class LocalizationManager {
  constructor() {
    this.currentLocale = 'pt-BR';
    this.init();
  }
  
  init() {
    this.updatePageLanguage();
    this.createLanguageSwitcher();
    this.bindEvents();
  }
  
  setLanguage(locale) {
    if (locales[locale]) {
      this.currentLocale = locale;
      this.updatePageLanguage();
      this.updateLanguageSwitcher();
      localStorage.setItem('grain-locale', locale);
    }
  }
  
  updatePageLanguage() {
    const locale = locales[this.currentLocale];
    
    // Update meta tags
    document.title = locale.title;
    document.querySelector('meta[name="description"]').setAttribute('content', locale.description);
    document.documentElement.lang = this.currentLocale;
    
    // Update all translatable elements
    this.updateElementText('[data-i18n]', locale);
    this.updateElementText('[data-i18n-placeholder]', locale, 'placeholder');
    this.updateElementText('[data-i18n-alt]', locale, 'alt');
    this.updateElementText('[data-i18n-title]', locale, 'title');
    this.updateElementText('[data-i18n-aria-label]', locale, 'aria-label');
    
    // Update CSS content for wishlist badge
    this.updateWishlistBadge(locale.wishlist);
    
    // Update gallery images based on locale
    this.updateGalleryImages(locale);
  }
  
  updateElementText(selector, locale, attribute = 'textContent') {
    const elements = document.querySelectorAll(selector);
    elements.forEach(element => {
      const key = element.getAttribute(attribute === 'textContent' ? 'data-i18n' : `data-i18n-${attribute}`);
      if (locale[key]) {
        if (attribute === 'textContent') {
          element.innerHTML = locale[key];
        } else {
          element.setAttribute(attribute, locale[key]);
        }
      }
    });
  }
  
  updateGalleryImages(locale) {
    if (!locale.galleryImages) return;
    
    const gallery = document.querySelector('.gallery');
    if (!gallery) return;
    
    // Clear existing images
    gallery.innerHTML = '';
    
    // Add new localized images
    locale.galleryImages.forEach((image, index) => {
      const link = document.createElement('a');
      link.href = image.src;
      link.className = 'glink';
      
      const img = document.createElement('img');
      img.src = image.src;
      img.setAttribute('data-i18n-alt', image.alt);
      img.alt = locale[image.alt] || `Screenshot ${index + 1}`;
      
      link.appendChild(img);
      gallery.appendChild(link);
    });
  }
  
  updateWishlistBadge(text) {
    // Update CSS custom property for wishlist badge text
    document.documentElement.style.setProperty('--wishlist-text', `"${text}"`);
    
    // Also update data attributes on steam links for CSS content
    const steamLinks = document.querySelectorAll('a[href="#steam"]');
    steamLinks.forEach(link => {
      link.setAttribute('data-wishlist', text);
    });
  }
  
  createLanguageSwitcher() {
    const header = document.querySelector('header .nav');
    const languageSwitcher = document.createElement('div');
    languageSwitcher.className = 'language-switcher';
    languageSwitcher.innerHTML = `
      <div class="lang-dropdown">
        <button class="lang-dropdown-btn" aria-haspopup="true" aria-expanded="false">
          <span class="lang-flag">🇧🇷</span>
          <span class="lang-text">PT</span>
          <span class="lang-arrow">▼</span>
        </button>
        <ul class="lang-dropdown-menu" role="menu">
          <li role="none">
            <button class="lang-option" data-locale="pt-BR" role="menuitem">
              <span class="lang-flag">🇧🇷</span>
              <span class="lang-name">Português</span>
            </button>
          </li>
          <li role="none">
            <button class="lang-option" data-locale="en-US" role="menuitem">
              <span class="lang-flag">🇺🇸</span>
              <span class="lang-name">English</span>
            </button>
          </li>
          <li role="none">
            <button class="lang-option" data-locale="de" role="menuitem">
              <span class="lang-flag">🇩🇪</span>
              <span class="lang-name">Deutsch</span>
            </button>
          </li>
          <li role="none">
            <button class="lang-option" data-locale="fr" role="menuitem">
              <span class="lang-flag">🇫🇷</span>
              <span class="lang-name">Français</span>
            </button>
          </li>
        </ul>
      </div>
    `;
    
    header.appendChild(languageSwitcher);
    
    // Add styles
    const style = document.createElement('style');
    style.textContent = `
      .language-switcher {
        position: relative;
        display: flex;
        align-items: center;
      }
      
      .lang-dropdown {
        position: relative;
      }
      
      .lang-dropdown-btn {
        display: flex;
        align-items: center;
        gap: 8px;
        background: none;
        border: 2px solid #1a2e63;
        border-radius: 8px;
        padding: 8px 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 14px;
        color: var(--text);
        min-width: 80px;
        justify-content: space-between;
      }
      
      .lang-dropdown-btn:hover {
        background: var(--primary);
        border-color: var(--primary);
        transform: translateY(-1px);
      }
      
      .lang-dropdown-btn:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(26, 46, 99, 0.3);
      }
      
      .lang-flag {
        font-size: 16px;
      }
      
      .lang-text {
        font-weight: 600;
        color: var(--text);
      }
      
      .lang-arrow {
        font-size: 10px;
        transition: transform 0.2s ease;
        color: var(--muted);
      }
      
      .lang-dropdown.active .lang-arrow {
        transform: rotate(180deg);
      }
      
      .lang-dropdown-menu {
        position: absolute;
        top: 100%;
        right: 0;
        background: var(--bg);
        border: 2px solid #1a2e63;
        border-radius: 8px;
        padding: 8px 0;
        margin-top: 4px;
        list-style: none;
        min-width: 140px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.2s ease;
        z-index: 1000;
      }
      
      .lang-dropdown.active .lang-dropdown-menu {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }
      
      .lang-option {
        display: flex;
        align-items: center;
        gap: 12px;
        width: 100%;
        padding: 10px 16px;
        background: none;
        border: none;
        cursor: pointer;
        transition: background-color 0.2s ease;
        color: var(--text);
        font-size: 14px;
        text-align: left;
      }
      
      .lang-option:hover {
        background: var(--primary);
        color: #3a2402;
      }
      
      .lang-option.active {
        background: var(--accent);
        color: #3a2402;
        font-weight: 600;
      }
      
      .lang-name {
        font-weight: 500;
      }
      
      /* Responsive adjustments */
      @media (max-width: 768px) {
        .lang-dropdown-btn {
          padding: 6px 10px;
          min-width: 70px;
        }
        
        .lang-text {
          display: none;
        }
        
        .lang-dropdown-menu {
          right: -20px;
        }
      }
    `;
    document.head.appendChild(style);
  }
  
  updateLanguageSwitcher() {
    // Update dropdown button
    const dropdownBtn = document.querySelector('.lang-dropdown-btn');
    if (dropdownBtn) {
      const flag = dropdownBtn.querySelector('.lang-flag');
      const text = dropdownBtn.querySelector('.lang-text');
      
      // Update flag and text based on current locale
      const localeInfo = {
        'pt-BR': { flag: '🇧🇷', text: 'PT' },
        'en-US': { flag: '🇺🇸', text: 'EN' },
        'de': { flag: '🇩🇪', text: 'DE' },
        'fr': { flag: '🇫🇷', text: 'FR' }
      };
      
      if (localeInfo[this.currentLocale]) {
        flag.textContent = localeInfo[this.currentLocale].flag;
        text.textContent = localeInfo[this.currentLocale].text;
      }
    }
    
    // Update active state in dropdown menu
    const options = document.querySelectorAll('.lang-option');
    options.forEach(option => {
      option.classList.toggle('active', option.dataset.locale === this.currentLocale);
    });
  }
  
  bindEvents() {
    // Handle dropdown toggle
    document.addEventListener('click', (e) => {
      const dropdown = document.querySelector('.lang-dropdown');
      const dropdownBtn = document.querySelector('.lang-dropdown-btn');
      
      if (e.target === dropdownBtn) {
        // Toggle dropdown
        dropdown.classList.toggle('active');
        const isExpanded = dropdown.classList.contains('active');
        dropdownBtn.setAttribute('aria-expanded', isExpanded);
      } else if (e.target.classList.contains('lang-option')) {
        // Language selection
        const locale = e.target.dataset.locale;
        this.setLanguage(locale);
        
        // Close dropdown
        dropdown.classList.remove('active');
        dropdownBtn.setAttribute('aria-expanded', 'false');
      } else if (!dropdown.contains(e.target)) {
        // Close dropdown when clicking outside
        dropdown.classList.remove('active');
        dropdownBtn.setAttribute('aria-expanded', 'false');
      }
    });
    
    // Handle keyboard navigation
    document.addEventListener('keydown', (e) => {
      const dropdown = document.querySelector('.lang-dropdown');
      const dropdownBtn = document.querySelector('.lang-dropdown-btn');
      
      if (e.key === 'Escape' && dropdown.classList.contains('active')) {
        dropdown.classList.remove('active');
        dropdownBtn.setAttribute('aria-expanded', 'false');
        dropdownBtn.focus();
      }
    });
    
    // Load saved language preference
    const savedLocale = localStorage.getItem('grain-locale');
    if (savedLocale && locales[savedLocale]) {
      this.setLanguage(savedLocale);
    }
  }
}

// Initialize localization when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
  new LocalizationManager();
});
